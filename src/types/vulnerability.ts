export type Severity = 'critical' | 'high' | 'medium' | 'low' | 'info';

export type VulnerabilityType =
  | 'secret_exposure'
  | 'api_key_exposed'
  | 'insecure_header'
  | 'cors_misconfiguration'
  | 'pii_exposure'
  | 'insecure_storage'
  | 'jwt_vulnerability'
  | 'session_vulnerability'
  | 'debug_exposure'
  | 'version_disclosure'
  | 'sql_injection'
  | 'xss_vulnerability'
  | 'csrf_vulnerability'
  | 'insecure_cookie'
  | 'source_map_exposure'
  | 'dependency_vulnerability'
  | 'graphql_introspection'
  | 'subdomain_takeover'
  | 'git_exposure'
  | 'backup_exposure'
  | 'cloud_misconfiguration';

export type LocationType = 'script' | 'storage' | 'network' | 'html' | 'cookie' | 'header' | 'url' | 'websocket';

export type Environment = 'development' | 'production' | 'staging' | 'unknown';

export interface VulnerabilityLocation {
  type: LocationType;
  url?: string;
  line?: number;
  column?: number;
  storageKey?: string;
  requestId?: string;
  selector?: string;
}

export interface RemediationStep {
  order: number;
  title: string;
  description: string;
  codeExample?: {
    vulnerable: string;
    secure: string;
    language: string;
  };
}

export interface Remediation {
  summary: string;
  steps: RemediationStep[];
  references: string[];
  timeEstimate: string;
  difficulty: 'easy' | 'medium' | 'hard';
}

export interface Impact {
  description: string;
  exploitScenario: string;
  dataAtRisk: string[];
  cvssScore?: number;
  cvssVector?: string;
}

export interface Vulnerability {
  id: string;
  type: VulnerabilityType;
  severity: Severity;
  title: string;
  description: string;
  location: VulnerabilityLocation;
  impact: Impact;
  remediation: Remediation;
  evidence: string;
  maskedEvidence: string;
  context: string;
  timestamp: number;
  environment: Environment;
  falsePositive: boolean;
  confirmed: boolean;
  owaspCategory?: string;
  cweId?: string;
  tags: string[];
  metadata: Record<string, unknown>;
}

export interface VulnerabilitySummary {
  total: number;
  bySeverity: Record<Severity, number>;
  byType: Record<string, number>;
  criticalCount: number;
  highCount: number;
  mediumCount: number;
  lowCount: number;
  infoCount: number;
}